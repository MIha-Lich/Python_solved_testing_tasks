Приветствую!
Рекомендую запустить скрипт сначала без параметров, затем в зависимости от необходимости.
В коде попытался предотвпратить всевозможные ошибки, которые могут возникнуть при вводе параметров запуска скрипта. 
